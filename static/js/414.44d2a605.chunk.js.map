{"version":3,"file":"static/js/414.44d2a605.chunk.js","mappings":"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","sources":["pages/MoodHistory.jsx"],"sourcesContent":["import React, { useEffect, useState, useCallback } from \"react\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nconst API = \"http://localhost:8080/api/journal\";\r\n\r\n/* ================= HELPERS ================= */\r\n\r\nfunction getDayName(dateStr) {\r\n  return new Date(dateStr).toLocaleDateString(\"en-US\", {\r\n    weekday: \"long\",\r\n  });\r\n}\r\n\r\nfunction moodStyle(label) {\r\n  switch ((label || \"\").toUpperCase()) {\r\n    case \"POSITIVE\":\r\n      return \"bg-green-50/80 border-green-200\";\r\n    case \"ANXIETY\":\r\n      return \"bg-orange-50/80 border-orange-200\";\r\n    case \"DEPRESSION\":\r\n      return \"bg-red-50/80 border-red-200\";\r\n    case \"SUICIDAL\":\r\n      return \"bg-rose-50/80 border-rose-300\";\r\n    default:\r\n      return \"bg-gray-50/80 border-gray-200\";\r\n  }\r\n}\r\n\r\n/* ================= MOOD STATS ================= */\r\n\r\nfunction calculateMoodStats(entries) {\r\n  const counts = {\r\n    POSITIVE: 0,\r\n    ANXIETY: 0,\r\n    DEPRESSION: 0,\r\n    SUICIDAL: 0,\r\n    NEUTRAL: 0,\r\n  };\r\n\r\n  entries.forEach((e) => {\r\n    const label = (e.label || \"NEUTRAL\").toUpperCase();\r\n    counts[label] = (counts[label] || 0) + 1;\r\n  });\r\n\r\n  const total =\r\n    Object.values(counts).reduce((a, b) => a + b, 0) || 1;\r\n\r\n  return { counts, total };\r\n}\r\n\r\n/* ================= MOOD BAR ================= */\r\n\r\nfunction MoodBar({ entries }) {\r\n  const { counts, total } = calculateMoodStats(entries);\r\n  const pct = (n) => Math.round((n / total) * 100);\r\n\r\n  return (\r\n    <div className=\"w-full h-4 rounded-full overflow-hidden flex bg-gray-200/70 mt-2 mb-4\">\r\n      {counts.POSITIVE > 0 && (\r\n        <div className=\"bg-green-500\" style={{ width: `${pct(counts.POSITIVE)}%` }} />\r\n      )}\r\n      {counts.ANXIETY > 0 && (\r\n        <div className=\"bg-orange-400\" style={{ width: `${pct(counts.ANXIETY)}%` }} />\r\n      )}\r\n      {counts.DEPRESSION > 0 && (\r\n        <div className=\"bg-red-500\" style={{ width: `${pct(counts.DEPRESSION)}%` }} />\r\n      )}\r\n      {counts.SUICIDAL > 0 && (\r\n        <div className=\"bg-rose-700\" style={{ width: `${pct(counts.SUICIDAL)}%` }} />\r\n      )}\r\n      {counts.NEUTRAL > 0 && (\r\n        <div className=\"bg-gray-400\" style={{ width: `${pct(counts.NEUTRAL)}%` }} />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ================= COMPONENT ================= */\r\n\r\nexport default function MoodHistory({ token }) {\r\n  const [grouped, setGrouped] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [deleteTarget, setDeleteTarget] = useState(null);\r\n  const [deleting, setDeleting] = useState(false);\r\n\r\n  /* Load history */\r\n  const loadHistory = useCallback(async () => {\r\n    try {\r\n      const res = await fetch(API, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n\r\n      const txt = await res.text();\r\n      const entries = txt ? JSON.parse(txt) : [];\r\n\r\n      const byDay = {};\r\n      entries.forEach((e) => {\r\n        const day = getDayName(e.createdAt);\r\n        if (!byDay[day]) byDay[day] = [];\r\n        byDay[day].push(e);\r\n      });\r\n\r\n      setGrouped(byDay);\r\n    } catch {\r\n      toast.error(\"Failed to load mood history\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (token) loadHistory();\r\n  }, [token, loadHistory]);\r\n\r\n  /* DELETE ENTRY */\r\n  const confirmDelete = async () => {\r\n    if (!deleteTarget) return;\r\n    setDeleting(true);\r\n\r\n    try {\r\n      const res = await fetch(`${API}/${deleteTarget.id}`, {\r\n        method: \"DELETE\",\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n\r\n      if (!res.ok) throw new Error();\r\n\r\n      toast.success(\"Journal entry deleted üóëÔ∏è\");\r\n      setDeleteTarget(null);\r\n      loadHistory();\r\n    } catch {\r\n      toast.error(\"Failed to delete entry\");\r\n    } finally {\r\n      setDeleting(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"text-center py-12 text-gray-500\">\r\n        Loading mood history‚Ä¶\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto px-4 py-10\">\r\n\r\n      {/* Header */}\r\n      <div className=\"mb-6\">\r\n        <h2 className=\"text-2xl font-semibold text-gray-800\">\r\n          Mood History\r\n        </h2>\r\n        <p className=\"text-sm text-gray-500\">\r\n          Day-wise emotional patterns from your journal\r\n        </p>\r\n      </div>\r\n\r\n      {/* Legend */}\r\n      <div className=\"flex flex-wrap gap-4 text-xs text-gray-600 mb-8\">\r\n        <Legend color=\"bg-green-500\" label=\"Positive\" />\r\n        <Legend color=\"bg-orange-400\" label=\"Anxiety\" />\r\n        <Legend color=\"bg-red-500\" label=\"Depression\" />\r\n        <Legend color=\"bg-rose-700\" label=\"Suicidal\" />\r\n        <Legend color=\"bg-gray-400\" label=\"Neutral\" />\r\n      </div>\r\n\r\n      {Object.keys(grouped).length === 0 && (\r\n        <p className=\"text-gray-500\">\r\n          No mood history yet. Start journaling üå±\r\n        </p>\r\n      )}\r\n\r\n      {/* Day-wise */}\r\n      <div className=\"space-y-10\">\r\n        {Object.entries(grouped).map(([day, entries]) => (\r\n          <div key={day}>\r\n            <h3 className=\"text-lg font-medium text-indigo-600\">\r\n              {day}\r\n            </h3>\r\n\r\n            <MoodBar entries={entries} />\r\n\r\n            <div className=\"grid sm:grid-cols-2 gap-4\">\r\n              {entries.map((e) => (\r\n                <div\r\n                  key={e.id}\r\n                  className={`relative rounded-xl border p-4 backdrop-blur-sm transition hover:shadow-md ${moodStyle(\r\n                    e.label\r\n                  )}`}\r\n                >\r\n                  {/* Delete */}\r\n                  <button\r\n                    onClick={() => setDeleteTarget(e)}\r\n                    className=\"absolute top-3 right-3 w-8 h-8 flex items-center justify-center rounded-full \r\n                    text-gray-400 hover:text-red-600 hover:bg-red-50 transition\"\r\n                    title=\"Delete entry\"\r\n                  >\r\n                    üóë\r\n                  </button>\r\n\r\n                  <div className=\"flex justify-between items-center mb-2 pr-8\">\r\n                    <span className=\"text-xs font-semibold uppercase text-gray-700\">\r\n                      {e.label || \"Not analyzed\"}\r\n                    </span>\r\n                    <span className=\"text-xs text-gray-400\">\r\n                      {new Date(e.createdAt).toLocaleTimeString([], {\r\n                        hour: \"2-digit\",\r\n                        minute: \"2-digit\",\r\n                      })}\r\n                    </span>\r\n                  </div>\r\n\r\n                  <p className=\"text-sm text-gray-700 line-clamp-3\">\r\n                    {e.content}\r\n                  </p>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* CONFIRM DELETE */}\r\n      {deleteTarget && (\r\n        <div className=\"fixed inset-0 bg-black/40 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-2xl p-6 w-full max-w-sm shadow-xl\">\r\n            <h3 className=\"text-lg font-semibold text-gray-800 mb-2\">\r\n              Delete this entry?\r\n            </h3>\r\n            <p className=\"text-sm text-gray-600 mb-4\">\r\n              This action cannot be undone.\r\n            </p>\r\n\r\n            <div className=\"flex justify-end gap-3\">\r\n              <button\r\n                onClick={() => setDeleteTarget(null)}\r\n                className=\"px-4 py-2 text-sm rounded-lg border hover:bg-gray-50\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={confirmDelete}\r\n                disabled={deleting}\r\n                className=\"px-4 py-2 text-sm rounded-lg bg-red-600 text-white hover:bg-red-700 disabled:opacity-50\"\r\n              >\r\n                {deleting ? \"Deleting‚Ä¶\" : \"Delete\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ================= LEGEND ================= */\r\n\r\nfunction Legend({ color, label }) {\r\n  return (\r\n    <span className=\"flex items-center gap-1\">\r\n      <span className={`w-3 h-3 rounded-full ${color}`} />\r\n      {label}\r\n    </span>\r\n  );\r\n}\r\n"],"names":["API","moodStyle","label","toUpperCase","MoodBar","_ref","entries","counts","total","POSITIVE","ANXIETY","DEPRESSION","SUICIDAL","NEUTRAL","forEach","e","Object","values","reduce","a","b","calculateMoodStats","pct","n","Math","round","_jsxs","className","children","_jsx","style","width","concat","MoodHistory","_ref2","token","grouped","setGrouped","useState","loading","setLoading","deleteTarget","setDeleteTarget","deleting","setDeleting","loadHistory","useCallback","async","res","fetch","headers","Authorization","txt","text","JSON","parse","byDay","day","dateStr","createdAt","Date","toLocaleDateString","weekday","push","_unused","toast","error","useEffect","Legend","color","keys","length","map","_ref3","onClick","title","toLocaleTimeString","hour","minute","content","id","method","ok","Error","success","_unused2","disabled","_ref4"],"ignoreList":[],"sourceRoot":""}