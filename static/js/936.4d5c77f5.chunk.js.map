{"version":3,"file":"static/js/936.4d5c77f5.chunk.js","mappings":"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","sources":["pages/Journal.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nconst API = \"http://localhost:8080/api/journal\";\r\nconst ML_API = \"http://127.0.0.1:8000/analyze_text\";\r\n\r\n/* ================= MOOD BADGES ================= */\r\n\r\nfunction emotionBadge(label) {\r\n  switch ((label || \"\").toUpperCase()) {\r\n    case \"SUICIDAL\":\r\n      return \"bg-rose-100 text-rose-800 border border-rose-200\";\r\n    case \"DEPRESSION\":\r\n      return \"bg-red-100 text-red-700 border border-red-200\";\r\n    case \"ANXIETY\":\r\n      return \"bg-amber-100 text-amber-800 border border-amber-200\";\r\n    case \"EUPHORIC\":\r\n      return \"bg-indigo-100 text-indigo-700 border border-indigo-200\";\r\n    case \"POSITIVE\":\r\n      return \"bg-green-100 text-green-700 border border-green-200\";\r\n    case \"NEUTRAL\":\r\n      return \"bg-slate-100 text-slate-700 border border-slate-200\";\r\n    default:\r\n      return \"bg-gray-100 text-gray-700 border border-gray-200\";\r\n  }\r\n}\r\n\r\nexport default function Journal({ token }) {\r\n  const [text, setText] = useState(\"\");\r\n  const [entries, setEntries] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [openId, setOpenId] = useState(null);\r\n  const [visibleCount, setVisibleCount] = useState(5);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  /* ================= LOAD JOURNAL ================= */\r\n\r\n  useEffect(() => {\r\n    if (!token) return;\r\n\r\n    fetch(API, {\r\n      headers: { Authorization: `Bearer ${token}` },\r\n    })\r\n      .then((res) => res.text())\r\n      .then((txt) => setEntries(txt ? JSON.parse(txt) : []))\r\n      .catch(() => toast.error(\"Failed to load journal\"));\r\n  }, [token]);\r\n\r\n  /* ================= SAVE ENTRY ================= */\r\n\r\n  const saveEntry = async () => {\r\n    if (!text.trim()) {\r\n      toast(\"Write something before saving âœï¸\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      // 1ï¸âƒ£ Analyze text (ML)\r\n      const mlRes = await fetch(ML_API, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ text }),\r\n      });\r\n      const ml = await mlRes.json();\r\n\r\n      // 2ï¸âƒ£ Save journal entry\r\n      await fetch(API, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify({\r\n          content: text,\r\n          label: ml.label,\r\n          suicidalScore: ml.suicidal_score,\r\n        }),\r\n      });\r\n\r\n      toast.success(\"Journal entry saved ðŸ“\");\r\n\r\n      setText(\"\");\r\n      setOpenId(null);\r\n\r\n      // 3ï¸âƒ£ Reload entries\r\n      const res = await fetch(API, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      const txt = await res.text();\r\n      setEntries(txt ? JSON.parse(txt) : []);\r\n\r\n      // 4ï¸âƒ£ Redirect only for high-risk\r\n      if (ml.support_recommended) {\r\n        toast(\"We recommend some support resources ðŸ’™\");\r\n        setTimeout(() => navigate(\"/support\"), 1500);\r\n      }\r\n    } catch (err) {\r\n      toast.error(\"Could not save entry\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  /* ================= UI ================= */\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto px-4 py-10\">\r\n\r\n      {/* Header */}\r\n      <div className=\"mb-8\">\r\n        <h1 className=\"text-2xl font-semibold text-gray-800\">\r\n          Daily Journal\r\n        </h1>\r\n        <p className=\"text-sm text-gray-500\">\r\n          Express your thoughts freely. This space is private and safe.\r\n        </p>\r\n      </div>\r\n\r\n      {/* Write Box */}\r\n      <div className=\"bg-white/80 backdrop-blur-xl rounded-2xl shadow-md border border-gray-100 p-6 mb-12\">\r\n        <textarea\r\n          rows={6}\r\n          className=\"\r\n            w-full resize-none rounded-xl border border-gray-200\r\n            p-4 text-sm leading-relaxed\r\n            focus:ring-2 focus:ring-indigo-500 focus:outline-none\r\n            transition\r\n          \"\r\n          placeholder=\"How are you feeling today?\"\r\n          value={text}\r\n          onChange={(e) => setText(e.target.value)}\r\n        />\r\n\r\n        <div className=\"flex justify-end mt-4\">\r\n          <button\r\n            onClick={saveEntry}\r\n            disabled={loading}\r\n            className=\"\r\n              px-6 py-2 rounded-xl\r\n              bg-indigo-600 text-white text-sm font-medium\r\n              hover:bg-indigo-700\r\n              transition\r\n              disabled:opacity-50\r\n            \"\r\n          >\r\n            {loading ? \"Analyzing...\" : \"Save Entry\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Past Entries */}\r\n      <h2 className=\"text-lg font-medium text-gray-700 mb-4\">\r\n        Past Entries\r\n      </h2>\r\n\r\n      {entries.length === 0 && (\r\n        <div className=\"text-sm text-gray-500 bg-gray-50 border border-gray-200 p-4 rounded-xl\">\r\n          No journal entries yet. Start by writing how you feel today ðŸŒ±\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"space-y-4 mt-4\">\r\n        {entries.slice(0, visibleCount).map((e) => {\r\n          const label = (e.label || \"NEUTRAL\").toUpperCase();\r\n\r\n          return (\r\n            <div\r\n              key={e.id}\r\n              className=\"bg-white rounded-xl shadow-sm border p-4 transition hover:shadow-md\"\r\n            >\r\n              {/* Header */}\r\n              <div\r\n                className=\"flex justify-between items-center cursor-pointer\"\r\n                onClick={() =>\r\n                  setOpenId(openId === e.id ? null : e.id)\r\n                }\r\n              >\r\n                <span\r\n                  className={`text-xs px-3 py-1 rounded-full font-medium ${emotionBadge(\r\n                    label\r\n                  )}`}\r\n                >\r\n                  {label}\r\n                </span>\r\n\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"text-xs text-gray-400\">\r\n                    {new Date(e.createdAt).toLocaleString()}\r\n                  </span>\r\n                  <span\r\n                    className={`text-gray-400 transition-transform ${\r\n                      openId === e.id ? \"rotate-180\" : \"\"\r\n                    }`}\r\n                  >\r\n                    â–¼\r\n                  </span>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Content */}\r\n              <div\r\n                className={`overflow-hidden transition-all duration-300 ${\r\n                  openId === e.id ? \"max-h-96 mt-4\" : \"max-h-0\"\r\n                }`}\r\n              >\r\n                <p className=\"text-gray-700 text-sm whitespace-pre-wrap\">\r\n                  {e.content}\r\n                </p>\r\n\r\n                {/* Support hints */}\r\n                {label === \"DEPRESSION\" && (\r\n                  <div className=\"mt-3 text-sm text-red-700 bg-red-50 border border-red-200 p-3 rounded-lg\">\r\n                    It looks like youâ€™re feeling emotionally low.\r\n                    Talking to someone you trust may help.\r\n                  </div>\r\n                )}\r\n\r\n                {label === \"EUPHORIC\" && (\r\n                  <div className=\"mt-3 text-sm text-indigo-700 bg-indigo-50 border border-indigo-200 p-3 rounded-lg\">\r\n                    You seem to be feeling very energized today.\r\n                  </div>\r\n                )}\r\n\r\n                {label === \"SUICIDAL\" && (\r\n                  <div className=\"mt-3 text-sm text-rose-700 bg-rose-50 border border-rose-200 p-3 rounded-lg\">\r\n                    You donâ€™t have to go through this alone. Support can help.\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {/* Load More */}\r\n      {entries.length > visibleCount && (\r\n        <div className=\"flex justify-center mt-8\">\r\n          <button\r\n            onClick={() => setVisibleCount((v) => v + 5)}\r\n            className=\"text-sm text-indigo-600 hover:underline\"\r\n          >\r\n            Load more entries\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["API","ML_API","emotionBadge","label","toUpperCase","Journal","_ref","token","text","setText","useState","entries","setEntries","loading","setLoading","openId","setOpenId","visibleCount","setVisibleCount","navigate","useNavigate","useEffect","fetch","headers","Authorization","concat","then","res","txt","JSON","parse","catch","toast","error","_jsxs","className","children","_jsx","rows","placeholder","value","onChange","e","target","onClick","async","trim","mlRes","method","body","stringify","ml","json","content","suicidalScore","suicidal_score","success","support_recommended","setTimeout","err","disabled","length","slice","map","id","Date","createdAt","toLocaleString","v"],"ignoreList":[],"sourceRoot":""}