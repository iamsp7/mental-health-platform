"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[414],{414:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i});var a=s(43),r=s(339),l=s(579);const n="http://localhost:8080/api/journal";function c(e){switch((e||"").toUpperCase()){case"POSITIVE":return"bg-green-50/80 border-green-200";case"ANXIETY":return"bg-orange-50/80 border-orange-200";case"DEPRESSION":return"bg-red-50/80 border-red-200";case"SUICIDAL":return"bg-rose-50/80 border-rose-300";default:return"bg-gray-50/80 border-gray-200"}}function o(e){let{entries:t}=e;const{counts:s,total:a}=function(e){const t={POSITIVE:0,ANXIETY:0,DEPRESSION:0,SUICIDAL:0,NEUTRAL:0};e.forEach(e=>{const s=(e.label||"NEUTRAL").toUpperCase();t[s]=(t[s]||0)+1});const s=Object.values(t).reduce((e,t)=>e+t,0)||1;return{counts:t,total:s}}(t),r=e=>Math.round(e/a*100);return(0,l.jsxs)("div",{className:"w-full h-4 rounded-full overflow-hidden flex bg-gray-200/70 mt-2 mb-4",children:[s.POSITIVE>0&&(0,l.jsx)("div",{className:"bg-green-500",style:{width:"".concat(r(s.POSITIVE),"%")}}),s.ANXIETY>0&&(0,l.jsx)("div",{className:"bg-orange-400",style:{width:"".concat(r(s.ANXIETY),"%")}}),s.DEPRESSION>0&&(0,l.jsx)("div",{className:"bg-red-500",style:{width:"".concat(r(s.DEPRESSION),"%")}}),s.SUICIDAL>0&&(0,l.jsx)("div",{className:"bg-rose-700",style:{width:"".concat(r(s.SUICIDAL),"%")}}),s.NEUTRAL>0&&(0,l.jsx)("div",{className:"bg-gray-400",style:{width:"".concat(r(s.NEUTRAL),"%")}})]})}function i(e){let{token:t}=e;const[s,i]=(0,a.useState)({}),[x,h]=(0,a.useState)(!0),[u,m]=(0,a.useState)(null),[g,b]=(0,a.useState)(!1),y=(0,a.useCallback)(async()=>{try{const e=await fetch(n,{headers:{Authorization:"Bearer ".concat(t)}}),s=await e.text(),a=s?JSON.parse(s):[],r={};a.forEach(e=>{const t=(s=e.createdAt,new Date(s).toLocaleDateString("en-US",{weekday:"long"}));var s;r[t]||(r[t]=[]),r[t].push(e)}),i(r)}catch(e){r.Ay.error("Failed to load mood history")}finally{h(!1)}},[t]);(0,a.useEffect)(()=>{t&&y()},[t,y]);return x?(0,l.jsx)("div",{className:"text-center py-12 text-gray-500",children:"Loading mood history\u2026"}):(0,l.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-10",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Mood History"}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Day-wise emotional patterns from your journal"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 text-xs text-gray-600 mb-8",children:[(0,l.jsx)(d,{color:"bg-green-500",label:"Positive"}),(0,l.jsx)(d,{color:"bg-orange-400",label:"Anxiety"}),(0,l.jsx)(d,{color:"bg-red-500",label:"Depression"}),(0,l.jsx)(d,{color:"bg-rose-700",label:"Suicidal"}),(0,l.jsx)(d,{color:"bg-gray-400",label:"Neutral"})]}),0===Object.keys(s).length&&(0,l.jsx)("p",{className:"text-gray-500",children:"No mood history yet. Start journaling \ud83c\udf31"}),(0,l.jsx)("div",{className:"space-y-10",children:Object.entries(s).map(e=>{let[t,s]=e;return(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-indigo-600",children:t}),(0,l.jsx)(o,{entries:s}),(0,l.jsx)("div",{className:"grid sm:grid-cols-2 gap-4",children:s.map(e=>(0,l.jsxs)("div",{className:"relative rounded-xl border p-4 backdrop-blur-sm transition hover:shadow-md ".concat(c(e.label)),children:[(0,l.jsx)("button",{onClick:()=>m(e),className:"absolute top-3 right-3 w-8 h-8 flex items-center justify-center rounded-full \r text-gray-400 hover:text-red-600 hover:bg-red-50 transition",title:"Delete entry",children:"\ud83d\uddd1"}),(0,l.jsxs)("div",{className:"flex justify-between items-center mb-2 pr-8",children:[(0,l.jsx)("span",{className:"text-xs font-semibold uppercase text-gray-700",children:e.label||"Not analyzed"}),(0,l.jsx)("span",{className:"text-xs text-gray-400",children:new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,l.jsx)("p",{className:"text-sm text-gray-700 line-clamp-3",children:e.content})]},e.id))})]},t)})}),u&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-xl",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Delete this entry?"}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"This action cannot be undone."}),(0,l.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,l.jsx)("button",{onClick:()=>m(null),className:"px-4 py-2 text-sm rounded-lg border hover:bg-gray-50",children:"Cancel"}),(0,l.jsx)("button",{onClick:async()=>{if(u){b(!0);try{if(!(await fetch("".concat(n,"/").concat(u.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok)throw new Error;r.Ay.success("Journal entry deleted \ud83d\uddd1\ufe0f"),m(null),y()}catch(e){r.Ay.error("Failed to delete entry")}finally{b(!1)}}},disabled:g,className:"px-4 py-2 text-sm rounded-lg bg-red-600 text-white hover:bg-red-700 disabled:opacity-50",children:g?"Deleting\u2026":"Delete"})]})]})})]})}function d(e){let{color:t,label:s}=e;return(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-3 h-3 rounded-full ".concat(t)}),s]})}}}]);
//# sourceMappingURL=414.44d2a605.chunk.js.map